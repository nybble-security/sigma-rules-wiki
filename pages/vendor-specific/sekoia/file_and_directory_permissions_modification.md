# How to process *File and Directory Permissions Modification* rule
In Linux environments, system binary paths contain critical executables. Adversaries may exploit these by altering file permissions to execute malicious payloads. The detection rule monitors processes like 'chmod' and 'chown' in key directories, flagging suspicious permission changes to prevent potential execution of harmful scripts.

# 1. Identify
- Review the process details to identify the exact command executed, focusing on the process name and arguments, especially those involving 'chmod' or 'chown' in critical directories like '/bin', '/usr/bin', and '/lib'.
- Check the user account associated with the process to verify if the action was performed by an authorized user or if there are signs of compromised credentials.
- Investigate the file or directory whose permissions were modified to assess its importance and potential impact, focusing on changes to permissions like '4755', '755', or '777'.
- Review recent changes or updates in the system that might explain the permission modification, ensuring they align with legitimate administrative tasks or software installations.

# 2. Contextualize
- Pivot to SIEM and check server logs the environment:
	- Assess whether this behavior is prevalent in the environment by looking for similar occurrences across hosts (Like automatic software update).
	- Check if script or software name seems generated by algorithm or match known malicious script.

# 3. Decide
Investigation has to be made on username, process name and permissions &rarr; Incident

# Known False Negatives
- Software installation or update (Wazuh, ...) with Apt, Yum, ...
